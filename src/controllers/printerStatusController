const { where } = require("sequelize")
const dadosbase = require("../database/db")
const PrinterStatus = require("../database/models/printerStatusModel")

const find = async () => {
    let dados = await PrinterStatus.findAll(
        {
            exclude: ["createdAt"],
            order: ["nomeFila"]
        }).catch(error => {
            console.log("Erro ao buscar as informacoes " + error)
        })

    return dados;
}

const findByName = async (nomeFila) => {
    let dados = await PrinterStatus.findOne({
        where: { nomeFila: nomeFila }
    }).catch(error => {
        console.log("Erro ao buscar as informacoes " + error)
    })

    return dados;
}

const create = (dados) => {

    PrinterStatus.create({
        nomeFila: dados.nomeFila,
        enderecoFila: dados.enderecoFila,
        rede: "Online",
        modelo: dados.modelo,
        fabricante: dados.fabricante,
        toner: dados.toner,
        unidadeImagem: dados.unidadeImagem,
        kitManutencao: dados.kitManutencao,
        contador: dados.contador,
        serial: dados.serial
    }).catch(error => {
        console.log("Erro ao salvar as informacoes da impressora: " + dados.nomeFila + " " + error)
    })
}

const update = (dados) => {

    PrinterStatus.update({
        nomeFila: dados.nomeFila,
        enderecoFila: dados.enderecoFila,
        rede: "Online",
        modelo: dados.modelo,
        fabricante: dados.fabricante,
        toner: dados.toner,
        unidadeImagem: dados.unidadeImagem,
        kitManutencao: dados.kitManutencao,
        contador: dados.contador,
        serial: dados.serial
    }, { where: { nomeFila: dados.nomeFila } })
        .catch(error => {
            console.log("Erro ao atualizar as informacoes da impressora: " + dados.nomeFila + " " + error)
        })
}

module.exports = {
    find,
    findByName,
    create,
    update,
}